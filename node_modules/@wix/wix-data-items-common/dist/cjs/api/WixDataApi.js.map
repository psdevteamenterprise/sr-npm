{"version":3,"names":["_errors","require","apiTypes","_interopRequireWildcard","_utils","_common","_WixDataQueryImpl","_WixDataResultImpl","_WixDataAggregateImpl","_ApiClient","_WixDataPatchImpl","_WixDataSearchImpl","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","WixDataApi","constructor","clientFactory","allowGet","environment","gridAppId","tracer","_defineProperty2","withArgs","args","collectionName","options","apiValidator","arity","validateAndReject","trace","env","client","truncateDataItems","dataCollectionId","toOptions","itemId","dataItem","getDataItem","dataItemId","toReadOptions","fields","catch","recover","ItemDoesNotExistCode","toDataItem","item","warnAboutBrokenFields","insertDataItem","id","_id","data","toUpdateOptions","saveDataItem","updateDataItem","removeDataItem","fieldModification","action","ACTION","SET_FIELD","fieldPath","setFieldOptions","value","actionOptions","REMOVE_FIELD","INCREMENT_FIELD","incrementFieldOptions","APPEND_TO_ARRAY","appendToArrayOptions","REMOVE_FROM_ARRAY","removeFromArrayOptions","Error","WixDataPatchImpl","onRun","_args","patchParams","fieldModifications","map","toFieldModificationApi","result","patchDataItem","patch","toPatchOptions","itemIds","WixDataBulkPatchImpl","results","bulkPatchDataItems","patches","toBulkResult","ensureValidQuery","invalidArgs","length","wdeValidationError","messages","queryValidations","queryInvalid","WixDataQueryImpl","onCount","params","invalidArguments","validateAndReturn","totalCount","countDataItems","filter","filterTree","onDistinct","field","_toSort$find","fieldName","order","toSort","orderBy","find","o","fetch","cursorOrOffset","returnTotalCount","distinctValues","pagingMetadata","queryDistinctValues","toPaging","limitNumber","isOffset","items","paging","skipNumber","WixDataResultImpl","onFind","dataItems","queryDataItems","query","projectedFields","sort","referencedItemOptions","included","WixDataSearchImpl","expression","queryText","request","search","fuzzy","isFuzzy","mode","searchMode","searchDataItems","cursor","limit","isNonEmptyString","WixDataAggregateImpl","validationErrors","aggregateValidations","aggregateInvalid","toOperation","itemFieldName","undefined","aggregateDataItems","initialFilter","aggregation","groupingFields","groupBy","operations","aggregates","resultFieldName","name","average","avg","min","max","sum","itemCount","count","finalFilter","havingTree","unwrapAggregationId","bulkRemoveOptions","bulkRemoveDataItems","dataItemIds","bulkInsertOptions","appId","runBulkSave","overrideExisting","bulkUpdateOptions","bulkUpdateDataItems","current","queryReferencedDataItems","onlyReferencedItems","holdingItem","relationshipAttribute","referenceParameter","referringItemId","referringItemFieldName","SortOrder","ASC","DESC","skip","refsOrAttr","leftOrOpts","right","refs","opts","argc","rights","asArray","relationshipName","left","references","bulkInsertDataItemReferences","dataItemReferences","referencedItemId","referenceParameters","replaceDataItemReferences","newReferencedItemIds","referenceRemoveParameters","bulkRemoveDataItemReferences","isReferenced","isReferencedDataItem","consistentRead","ApiClient","wixData","filterBuilder","bulkSaveDataItems","bulkInsertDataItems","ignoreCodes","fn","exports","arguments","suppressHooks","draftsOptions","showDrafts","includeReferencedItems","includeReferences","res","appOptions","entries","every","kv","language","publishPluginOptions","includeDraftItems","cursorPaging","offset","fieldOrder","providerOrValue","code","error","_details","details","applicationError","Promise","resolve","reject","hasFieldWithDollar","hasField","key","startsWith","hasFieldWithDot","includes","console","warn","errors","flatMap","_r$itemMetadata","_r$itemMetadata2","itemMetadata","success","BulkError","description","originalIndex","_r$itemMetadata3","inserted","BulkActionType","INSERT","updated","UPDATE","PATCH","removed","DELETE","skipped","insertedItemIds","_r$itemMetadata4","updatedItemIds","_r$itemMetadata5","removedItemIds","_r$itemMetadata6","isObject","rest","keys","notEmpty","xOrXs","isArray","commonApiValidator"],"sources":["../../../src/api/WixDataApi.ts"],"sourcesContent":["import {\n  apiValidator as commonApiValidator,\n  messages,\n  BulkError,\n  wdeValidationError,\n} from '../errors'\nimport { HttpApiClientFactory } from '../types'\nimport * as apiTypes from '../types/data-item-types'\n\nimport { hasField, isObject, isArray } from '../utils'\nimport { filterBuilder } from './common'\nimport {\n  Provider,\n  WixDataBulkResult,\n  WixDataItem,\n  WixDataItemOrId,\n  WixDataOptions,\n  WixDataPatchOptions,\n  WixDataQueryReferencedOptions,\n  WixDataReadOptions,\n  WixDataReadWithProjectionOptions,\n  WixDataReference,\n  WixDataUpdateOptions,\n} from './types'\nimport { QueryParams, WixDataQueryImpl } from './impl/WixDataQueryImpl'\nimport { WixDataQuery } from './WixDataQuery'\nimport { WixDataResultImpl, PageFetcher } from './impl/WixDataResultImpl'\nimport { WixDataAggregateImpl } from './impl/WixDataAggregateImpl'\nimport { ApiClient } from './ApiClient'\nimport {\n  WixDataPatch,\n  FieldModification,\n  WixDataBulkPatch,\n} from './WixDataPatch'\nimport { WixDataAggregate } from './WixDataAggregate'\nimport { WixDataFilter } from './WixDataFilter'\nimport { WixDataResult } from './WixDataResult'\nimport { WixDataBulkPatchImpl, WixDataPatchImpl } from './impl/WixDataPatchImpl'\nimport { WixDataSearch } from './WixDataSearch'\nimport { WixDataSearchImpl } from './impl/WixDataSearchImpl'\n\ntype ProvidedOpt<T> = T | undefined | Provider<T | undefined>\ntype TraceWith = (\n  label: string,\n  opts?: object\n) => <T>(fn: () => Promise<T>) => Promise<T>\n\nexport class WixDataApi {\n  private client: ApiClient\n\n  constructor(\n    clientFactory: HttpApiClientFactory<any>,\n    allowGet: boolean,\n    private readonly environment?: apiTypes.Environment,\n    private readonly gridAppId?: ProvidedOpt<string>,\n    private readonly tracer?: TraceWith\n  ) {\n    this.client = new ApiClient(clientFactory, allowGet)\n  }\n\n  get wixData(): WixDataApi {\n    return this\n  }\n\n  get filter(): WixDataFilter {\n    return filterBuilder()\n  }\n\n  // NOTE sort method for builder is not implemented\n\n  truncate = withArgs(\n    async (\n      args,\n      collectionName: string,\n      options?: WixDataOptions\n    ): Promise<void> => {\n      await apiValidator()\n        .arity('truncate', args, 1, 2)\n        .collectionName(collectionName)\n        .options(options)\n        .validateAndReject()\n\n      return this.trace('truncate', { collectionName })(async (env) => {\n        await this.client.truncateDataItems({\n          ...env,\n          dataCollectionId: collectionName,\n          ...toOptions(options),\n        })\n      })\n    }\n  )\n\n  // --- single-item methods ---\n\n  get = withArgs(\n    async (\n      args,\n      collectionName: string,\n      itemId: string,\n      options?: WixDataReadWithProjectionOptions\n    ): Promise<WixDataItem | null> => {\n      await apiValidator()\n        .arity('get', args, 2, 3)\n        .collectionName(collectionName)\n        .itemId(itemId)\n        .options(options)\n        .validateAndReject()\n\n      return this.trace('get', { collectionName, itemId })(async (env) => {\n        const { dataItem } = await this.client\n          .getDataItem({\n            ...env,\n            dataCollectionId: collectionName,\n            dataItemId: itemId,\n            ...toReadOptions(options),\n            fields: options?.fields,\n          })\n          .catch(\n            recover(ItemDoesNotExistCode, {} as apiTypes.GetDataItemResponse)\n          )\n\n        return dataItem ? toDataItem(dataItem) : null\n      })\n    }\n  )\n\n  insert = withArgs(\n    async (\n      args,\n      collectionName: string,\n      item: Partial<WixDataItem>,\n      options?: WixDataUpdateOptions\n    ): Promise<WixDataItem> => {\n      await apiValidator()\n        .arity('insert', args, 2, 3)\n        .collectionName(collectionName)\n        .item(item, collectionName, false)\n        .options(options)\n        .validateAndReject()\n\n      warnAboutBrokenFields(item)\n\n      return this.trace('insert', { collectionName })(async (env) => {\n        const { dataItem } = await this.client.insertDataItem({\n          ...env,\n          dataCollectionId: collectionName,\n          dataItem: {\n            id: item._id,\n            data: item,\n          },\n          ...toUpdateOptions(options),\n        })\n\n        return toDataItem(dataItem!)\n      })\n    }\n  )\n\n  save = withArgs(\n    async (\n      args,\n      collectionName: string,\n      item: Partial<WixDataItem>,\n      options?: WixDataUpdateOptions\n    ): Promise<WixDataItem> => {\n      await apiValidator()\n        .arity('save', args, 2, 3)\n        .collectionName(collectionName)\n        .item(item, collectionName, false)\n        .options(options)\n        .validateAndReject()\n\n      return this.trace('save', { collectionName })(async (env) => {\n        const { dataItem } = await this.client.saveDataItem({\n          ...env,\n          dataCollectionId: collectionName,\n          dataItem: {\n            id: item._id,\n            data: item,\n          },\n          ...toUpdateOptions(options),\n        })\n        return toDataItem(dataItem!)\n      })\n    }\n  )\n\n  update = withArgs(\n    async (\n      args,\n      collectionName: string,\n      item: WixDataItem,\n      options?: WixDataUpdateOptions\n    ) => {\n      await apiValidator()\n        .arity('update', args, 2, 3)\n        .collectionName(collectionName)\n        .item(item, collectionName, false)\n        .options(options)\n        .validateAndReject()\n\n      return this.trace('update', { collectionName })(async (env) => {\n        const { dataItem } = await this.client.updateDataItem({\n          ...env,\n          dataCollectionId: collectionName,\n          dataItem: {\n            id: item._id,\n            data: item,\n          },\n          ...toUpdateOptions(options),\n        })\n        return toDataItem(dataItem!)\n      })\n    }\n  )\n\n  remove = withArgs(\n    async (\n      args,\n      collectionName: string,\n      itemId: string,\n      options?: WixDataOptions\n    ): Promise<WixDataItem | null> => {\n      await apiValidator()\n        .arity('remove', args, 2, 3)\n        .collectionName(collectionName)\n        .itemId(itemId)\n        .options(options)\n        .validateAndReject()\n\n      return this.trace('remove', { collectionName, itemId })(async (env) => {\n        const { dataItem } = await this.client\n          .removeDataItem({\n            ...env,\n            dataCollectionId: collectionName,\n            dataItemId: itemId,\n            ...toOptions(options),\n          })\n          .catch(\n            recover(ItemDoesNotExistCode, {} as apiTypes.GetDataItemResponse)\n          )\n        return dataItem ? toDataItem(dataItem) : null\n      })\n    }\n  )\n\n  private toFieldModificationApi = (fieldModification: FieldModification) => {\n    switch (fieldModification.action) {\n      case 'SET_FIELD':\n        return {\n          action: apiTypes.ACTION.SET_FIELD,\n          fieldPath: fieldModification.fieldPath,\n          setFieldOptions: {\n            value: fieldModification.actionOptions,\n          },\n        }\n      case 'REMOVE_FIELD':\n        return {\n          action: apiTypes.ACTION.REMOVE_FIELD,\n          fieldPath: fieldModification.fieldPath,\n        }\n      case 'INCREMENT_FIELD':\n        return {\n          action: apiTypes.ACTION.INCREMENT_FIELD,\n          fieldPath: fieldModification.fieldPath,\n          incrementFieldOptions: {\n            value: fieldModification.actionOptions,\n          },\n        }\n      case 'APPEND_TO_ARRAY':\n        return {\n          action: apiTypes.ACTION.APPEND_TO_ARRAY,\n          fieldPath: fieldModification.fieldPath,\n          appendToArrayOptions: {\n            value: fieldModification.actionOptions,\n          },\n        }\n      case 'REMOVE_FROM_ARRAY':\n        return {\n          action: apiTypes.ACTION.REMOVE_FROM_ARRAY,\n          fieldPath: fieldModification.fieldPath,\n          removeFromArrayOptions: {\n            value: fieldModification.actionOptions,\n          },\n        }\n      default:\n        throw new Error('Invalid patch action')\n    }\n  }\n\n  patch = (collectionName: string, itemId: string): WixDataPatch => {\n    return new WixDataPatchImpl({\n      collectionName,\n      itemId,\n      onRun: async (_args, patchParams, options) => {\n        const fieldModifications = patchParams.fieldModifications.map(\n          this.toFieldModificationApi\n        )\n\n        return this.trace('patch', { collectionName })(async (env) => {\n          const result = await this.client.patchDataItem({\n            ...env,\n            dataCollectionId: patchParams.collectionName,\n            patch: {\n              dataItemId: patchParams.itemId,\n              fieldModifications,\n            },\n            ...toPatchOptions(options),\n          })\n\n          return result.dataItem ? toDataItem(result.dataItem) : null\n        })\n      },\n    })\n  }\n\n  bulkPatch = (collectionName: string, itemIds: string[]): WixDataBulkPatch => {\n    return new WixDataBulkPatchImpl({\n      collectionName,\n      itemIds,\n      onRun: async (_args, patchParams, options) => {\n        const fieldModifications = patchParams.fieldModifications.map(\n          this.toFieldModificationApi\n        )\n\n        return this.trace('bulkPatch', { collectionName })(async (env) => {\n          const { results } = await this.client.bulkPatchDataItems({\n            ...env,\n            dataCollectionId: patchParams.collectionName,\n            patches: patchParams.itemIds.map((itemId) => ({\n              dataItemId: itemId,\n              fieldModifications,\n            })),\n            ...toPatchOptions(options),\n          })\n\n          return toBulkResult(itemIds, results!, ['WDE0073'])\n        })\n      },\n    })\n  }\n\n  // --- query, count, distinct ---\n\n  query = (collectionName: string): WixDataQuery => {\n    const ensureValidQuery = (invalidArgs: string[]) => {\n      if (invalidArgs.length > 0) {\n        throw wdeValidationError(\n          messages.queryValidations.queryInvalid(collectionName, invalidArgs)\n        )\n      }\n    }\n\n    return new WixDataQueryImpl({\n      collectionName,\n      onCount: async (args, params, options) => {\n        ensureValidQuery([\n          ...params.invalidArguments,\n          ...apiValidator()\n            .collectionName(collectionName)\n            .arity('count', args, 0, 1)\n            .options(options)\n            .validateAndReturn(),\n        ])\n\n        return this.trace('count', { collectionName })(async (env) => {\n          const { totalCount } = await this.client.countDataItems({\n            ...env,\n            dataCollectionId: collectionName,\n            filter: params.filterTree,\n            ...toReadOptions(options),\n          })\n          return totalCount!\n        })\n      },\n      onDistinct: async (args, params, field, options) => {\n        ensureValidQuery([\n          ...params.invalidArguments,\n          ...apiValidator()\n            .collectionName(collectionName)\n            .arity('distinct', args, 1, 2)\n            .fieldName(field)\n            .options(options)\n            .validateAndReturn(),\n        ])\n\n        const order = toSort(params.orderBy).find(\n          (o) => o.fieldName === field\n        )?.order\n\n        const fetch: PageFetcher<any> = (cursorOrOffset, returnTotalCount) =>\n          this.trace('distinct', { collectionName, field })(async (env) => {\n            const { distinctValues, pagingMetadata } =\n              await this.client.queryDistinctValues({\n                ...env,\n                dataCollectionId: collectionName,\n                ...toReadOptions(options),\n                ...toPaging(params.limitNumber, cursorOrOffset),\n                ...(isOffset(cursorOrOffset)\n                  ? {\n                      fieldName: field,\n                      filter: params.filterTree,\n                      order,\n                      returnTotalCount,\n                    }\n                  : {}),\n              })\n            return [distinctValues!, pagingMetadata!]\n          })\n\n        const [items, paging] = await fetch(\n          params.skipNumber,\n          options?.returnTotalCount\n        )\n\n        return new WixDataResultImpl(items, paging, fetch, params)\n      },\n      onFind: async (args, params, options) => {\n        ensureValidQuery([\n          ...params.invalidArguments,\n          ...apiValidator()\n            .collectionName(collectionName)\n            .arity('find', args, 0, 1)\n            .options(options)\n            .validateAndReturn(),\n        ])\n\n        const fetch: PageFetcher = (cursorOrOffset, returnTotalCount) =>\n          this.trace('query', { collectionName })(async (env) => {\n            const { dataItems, pagingMetadata } =\n              await this.client.queryDataItems({\n                ...env,\n                dataCollectionId: collectionName,\n                query: {\n                  fields: params.projectedFields,\n                  ...toPaging(params.limitNumber, cursorOrOffset),\n                  ...(isOffset(cursorOrOffset)\n                    ? {\n                        filter: params.filterTree,\n                        sort: toSort(params.orderBy),\n                      }\n                    : {}),\n                },\n                referencedItemOptions: params.included,\n                ...toReadOptions(options),\n                ...(isOffset(cursorOrOffset) ? { returnTotalCount } : {}),\n              })\n            return [dataItems!.map(toDataItem), pagingMetadata!]\n          })\n        const [items, paging] = await fetch(\n          params.skipNumber,\n          options?.returnTotalCount\n        )\n\n        return new WixDataResultImpl(items, paging, fetch, params)\n      },\n    })\n  }\n\n  search = (collectionName: string): WixDataSearch => {\n    const ensureValidQuery = (invalidArgs: string[]) => {\n      if (invalidArgs.length > 0) {\n        throw wdeValidationError(\n          messages.queryValidations.queryInvalid(collectionName, invalidArgs)\n        )\n      }\n    }\n\n    return new WixDataSearchImpl({\n      collectionName,\n      onRun: async (\n        params,\n        options?: WixDataReadOptions\n      ): Promise<WixDataResult> => {\n        ensureValidQuery([\n          ...params.invalidArguments,\n          ...apiValidator()\n            .collectionName(collectionName)\n            .options(options)\n            .validateAndReturn(),\n        ])\n\n        const expression = params.queryText\n\n        const fetch: PageFetcher = (cursorOrOffset) =>\n          this.trace('search', { collectionName, expression })(async (env) => {\n            const request: apiTypes.SearchDataItemsRequest = {\n              ...env,\n              dataCollectionId: collectionName,\n              search: {\n                filter: params.filterTree,\n                sort: toSort(params.orderBy),\n                fields: params.projectedFields,\n                search: {\n                  expression: params.queryText,\n                  fuzzy: params.isFuzzy,\n                  mode: params.searchMode,\n                },\n                ...toPaging(params.limitNumber, cursorOrOffset),\n              },\n              referencedItemOptions: params.included,\n              ...toReadOptions(options),\n            }\n\n            const { dataItems, pagingMetadata } =\n              await this.client.searchDataItems(request)\n            return [dataItems!.map(toDataItem), pagingMetadata!]\n          })\n\n        const [items, paging] = await fetch(params.skipNumber)\n\n        return new WixDataResultImpl(items, paging, fetch, params)\n      },\n    })\n  }\n\n  // NOTE find method is not implemented\n\n  fetch = withArgs(\n    async (\n      args,\n      collectionName: string,\n      cursor: string,\n      limit?: number,\n      options?: WixDataReadOptions\n    ): Promise<WixDataResult> => {\n      await apiValidator()\n        .arity('fetch', args, 2, 4)\n        .collectionName(collectionName)\n        .isNonEmptyString(cursor, 'cursor')\n        .validateAndReject()\n\n      const fetch: PageFetcher = (cursorOrOffset) =>\n        this.trace('query', { collectionName })(async (env) => {\n          const { dataItems, pagingMetadata } =\n            await this.client.queryDataItems({\n              ...env,\n              dataCollectionId: collectionName,\n              query: {\n                ...toPaging(limit, cursorOrOffset),\n              },\n              ...toReadOptions(options),\n            })\n          return [dataItems!.map(toDataItem), pagingMetadata!]\n        })\n      const [items, paging] = await fetch(cursor)\n\n      return new WixDataResultImpl(items, paging, fetch, {\n        limitNumber: limit,\n        collectionName,\n        skipNumber: 0,\n      })\n    }\n  )\n\n  // --- aggregate ---\n\n  aggregate = (collectionName: string): WixDataAggregate => {\n    return new WixDataAggregateImpl({\n      collectionName,\n      onRun: async (args, params, options) => {\n        const validationErrors = [\n          ...params.invalidArguments,\n          ...apiValidator()\n            .arity('run', args, 0, 1)\n            .collectionName(collectionName)\n            .options(options)\n            .validateAndReturn(),\n        ]\n\n        if (validationErrors.length > 0) {\n          throw wdeValidationError(\n            messages.aggregateValidations.aggregateInvalid(\n              collectionName,\n              validationErrors\n            )\n          )\n        }\n\n        const fetch: PageFetcher<Record<string, any>> = (\n          cursorOrOffset,\n          returnTotalCount\n        ) =>\n          this.trace('aggregate', { collectionName })(async (env) => {\n            const toOperation = (field?: string) =>\n              field ? { itemFieldName: field } : undefined\n\n            const { results, pagingMetadata } =\n              await this.client.aggregateDataItems({\n                ...env,\n                dataCollectionId: collectionName,\n                ...toPaging(params.limitNumber, cursorOrOffset),\n                ...toReadOptions(options),\n                ...(isOffset(cursorOrOffset)\n                  ? {\n                      initialFilter: params.filterTree,\n                      aggregation: {\n                        groupingFields: params.groupBy,\n                        operations: params.aggregates.map((a) => ({\n                          resultFieldName: a.name,\n                          average: toOperation(a.avg),\n                          min: toOperation(a.min),\n                          max: toOperation(a.max),\n                          sum: toOperation(a.sum),\n                          itemCount: a.count ? {} : undefined,\n                        })),\n                      },\n                      finalFilter: params.havingTree,\n                      sort: toSort(params.orderBy),\n                      returnTotalCount,\n                    }\n                  : {}),\n              })\n            return [unwrapAggregationId(results!), pagingMetadata!]\n          })\n\n        const [items, paging] = await fetch(\n          params.skipNumber,\n          options?.returnTotalCount\n        )\n\n        return new WixDataResultImpl(items, paging, fetch, params)\n      },\n    })\n  }\n\n  fetchAggregate = withArgs(\n    async (\n      args,\n      collectionName: string,\n      cursor: string,\n      limit?: number,\n      options?: WixDataReadOptions\n    ) => {\n      await apiValidator()\n        .arity('fetchAggregate', args, 2, 4)\n        .collectionName(collectionName)\n        .isNonEmptyString(cursor, 'cursor')\n        .validateAndReject()\n\n      const fetch: PageFetcher<Record<string, any>> = (cursorOrOffset) =>\n        this.trace('aggregate', { collectionName })(async (env) => {\n          const { results, pagingMetadata } =\n            await this.client.aggregateDataItems({\n              ...env,\n              dataCollectionId: collectionName,\n              ...toPaging(limit, cursorOrOffset),\n              ...toReadOptions(options),\n            })\n          return [unwrapAggregationId(results!), pagingMetadata!]\n        })\n\n      const [items, paging] = await fetch(cursor, true)\n\n      return new WixDataResultImpl(items, paging, fetch, {\n        limitNumber: limit,\n        skipNumber: 0,\n        collectionName,\n      })\n    }\n  )\n\n  // --- bulk methods ---\n\n  bulkRemove = withArgs(\n    async (\n      args,\n      collectionName: string,\n      itemIds: string[],\n      options?: WixDataOptions\n    ): Promise<WixDataBulkResult> => {\n      await apiValidator()\n        .arity('bulkRemove', args, 2, 3)\n        .collectionName(collectionName)\n        .itemIds(itemIds, collectionName)\n        .bulkRemoveOptions(options)\n        .validateAndReject()\n\n      return this.trace('bulkRemove', { collectionName })(async (env) => {\n        const { results } = await this.client.bulkRemoveDataItems({\n          ...env,\n          dataCollectionId: collectionName,\n          dataItemIds: itemIds,\n          ...toOptions(options),\n        })\n        // Non-existing items are skipped and not reported as errors.\n        return toBulkResult(itemIds, results!, ['WDE0073'])\n      })\n    }\n  )\n\n  private async runBulkSave(\n    env: { environment?: apiTypes.Environment; appId?: string },\n    collectionName: string,\n    items: Partial<WixDataItem>[],\n    options?: WixDataOptions,\n    overrideExisting: boolean = true\n  ): Promise<WixDataBulkResult> {\n    const request: apiTypes.BulkInsertDataItemsRequest = {\n      ...env,\n      dataCollectionId: collectionName,\n      dataItems: items.map((data) => ({\n        id: data._id,\n        data,\n      })),\n      ...toOptions(options),\n    }\n    const { results } = await (overrideExisting\n      ? this.client.bulkSaveDataItems(request)\n      : this.client.bulkInsertDataItems(request))\n    const ignoreCodes = overrideExisting ? [] : ['WDE0074']\n    return toBulkResult(items, results!, ignoreCodes)\n  }\n\n  bulkInsert = withArgs(\n    async (\n      args,\n      collectionName: string,\n      items: Partial<WixDataItem>[],\n      options?: WixDataOptions & { overrideExisting?: boolean }\n    ): Promise<WixDataBulkResult> => {\n      await apiValidator()\n        .arity('bulkInsert', args, 2, 3)\n        .items(items, collectionName)\n        .bulkInsertOptions(options)\n        .collectionName(collectionName)\n        .validateAndReject()\n\n      return this.trace('bulkInsert', { collectionName, options })(\n        async (appId) =>\n          this.runBulkSave(\n            appId,\n            collectionName,\n            items,\n            options,\n            options?.overrideExisting ?? false\n          )\n      )\n    }\n  )\n\n  bulkSave = withArgs(\n    async (\n      args,\n      collectionName: string,\n      items: Partial<WixDataItem>[],\n      options?: WixDataOptions\n    ): Promise<WixDataBulkResult> => {\n      await apiValidator()\n        .arity('bulkSave', args, 2, 3)\n        .bulkInsertOptions(options)\n        .collectionName(collectionName)\n        .items(items, collectionName)\n        .validateAndReject()\n\n      return this.trace('bulkSave', { collectionName })(async (env) =>\n        this.runBulkSave(env, collectionName, items, options)\n      )\n    }\n  )\n\n  bulkUpdate = withArgs(\n    async (\n      args,\n      collectionName: string,\n      items: WixDataItem[],\n      options?: WixDataOptions\n    ): Promise<WixDataBulkResult> => {\n      await apiValidator()\n        .arity('bulkUpdate', args, 2, 3)\n        .bulkUpdateOptions(options)\n        .collectionName(collectionName)\n        .items(items, collectionName)\n        .validateAndReject()\n\n      return this.trace('bulkUpdate', { collectionName })(async (env) => {\n        const { results } = await this.client.bulkUpdateDataItems({\n          ...env,\n          dataCollectionId: collectionName,\n          dataItems: items.map((data) => ({\n            id: data._id,\n            data,\n          })),\n          ...toOptions(options),\n        })\n        // Non-existing items are skipped and not reported as errors.\n        return toBulkResult(items, results!, ['WDE0073'])\n      })\n    }\n  )\n\n  // --- references ---\n\n  fetchReferenced = withArgs(\n    async (\n      args,\n      collectionName: string,\n      cursor: string,\n      limit?: number,\n      options?: WixDataReadWithProjectionOptions\n    ): Promise<WixDataResult<WixDataItem | string>> => {\n      await apiValidator()\n        .arity('fetchReferenced', args, 2, 4)\n        .isNonEmptyString(cursor, 'cursor')\n        .collectionName(collectionName)\n        .validateAndReject()\n\n      const fetch: PageFetcher<WixDataItem | string> = (current) =>\n        this.trace('fetchReferenced', { collectionName })(async (env) => {\n          const { results, pagingMetadata } =\n            await this.client.queryReferencedDataItems({\n              ...env,\n              ...toPaging(limit, current),\n              ...toReadOptions(options),\n              dataCollectionId: collectionName,\n              fields: options?.fields,\n            })\n          return [onlyReferencedItems(results!), pagingMetadata!]\n        })\n\n      const [items, paging] = await fetch(cursor)\n      return new WixDataResultImpl(items, paging, fetch, {\n        collectionName,\n        limitNumber: limit,\n        skipNumber: 0,\n      })\n    }\n  )\n\n  queryReferenced = withArgs(\n    async (\n      args,\n      collectionName: string,\n      holdingItem: WixDataItemOrId,\n      relationshipAttribute: string,\n      options?: WixDataQueryReferencedOptions\n    ): Promise<WixDataResult> => {\n      await apiValidator()\n        .arity('queryReferenced', args, 3, 4)\n        .collectionName(collectionName)\n        .referenceParameter(holdingItem)\n        .isNonEmptyString(relationshipAttribute, 'relationshipAttribute')\n        .options(options)\n        .validateAndReject()\n\n      const id = itemId(holdingItem)\n      const fetch: PageFetcher = (cursorOrOffset, returnTotalCount) =>\n        this.trace('queryReferenced', {\n          collectionName,\n          itemId: id,\n          options,\n          relationshipAttribute,\n        })(async (env) => {\n          const { results, pagingMetadata } =\n            await this.client.queryReferencedDataItems({\n              ...env,\n              ...toPaging(options?.limit ?? 50, cursorOrOffset),\n              ...toReadOptions(options),\n              dataCollectionId: collectionName,\n              fields: options?.fields,\n              ...(isOffset(cursorOrOffset)\n                ? {\n                    referringItemId: id,\n                    referringItemFieldName: relationshipAttribute,\n                    order:\n                      options?.order === 'asc'\n                        ? apiTypes.SortOrder.ASC\n                        : options?.order === 'desc'\n                        ? apiTypes.SortOrder.DESC\n                        : undefined,\n                    returnTotalCount,\n                  }\n                : {}),\n            })\n          return [onlyReferencedItems(results!), pagingMetadata!]\n        })\n\n      const [items, paging] = await fetch(\n        options?.skip ?? 0,\n        options?.returnTotalCount\n      )\n      return new WixDataResultImpl(items, paging, fetch, {\n        collectionName,\n        limitNumber: options?.limit ?? 50,\n        skipNumber: options?.skip ?? 0,\n      })\n    }\n  )\n\n  insertReference: {\n    // overload with array of references\n    (\n      collectionName: string,\n      refs: WixDataReference[],\n      options?: WixDataOptions\n    ): Promise<void>\n    // overload with separate left and right(s)\n    (\n      collectionName: string,\n      relationshipAttribute: string,\n      left: WixDataItemOrId,\n      right: WixDataItemOrId | WixDataItemOrId[],\n      options?: WixDataOptions\n    ): Promise<void>\n  } = withArgs(\n    async (\n      args,\n      collectionName: string,\n      refsOrAttr: any,\n      leftOrOpts?: any,\n      right?: any,\n      options?: any\n    ) => {\n      let refs: WixDataReference[]\n      let opts: WixDataOptions\n      let argc: [number, number]\n\n      if (typeof refsOrAttr === 'string') {\n        const rights: WixDataItemOrId[] = asArray(right)\n        refs = rights.map((r) => ({\n          relationshipName: refsOrAttr,\n          left: leftOrOpts as WixDataItemOrId,\n          right: r,\n        }))\n        opts = options\n        argc = [4, 5]\n      } else {\n        refs = refsOrAttr\n        opts = leftOrOpts\n        argc = [2, 3]\n      }\n      await apiValidator()\n        .arity('insertReference', args, ...argc)\n        .collectionName(collectionName)\n        .references(refs)\n        .options(opts)\n        .validateAndReject()\n\n      await this.trace('insertReference', { collectionName })(async (env) =>\n        this.client.bulkInsertDataItemReferences({\n          ...env,\n          dataCollectionId: collectionName,\n          dataItemReferences: refs.map((r) => ({\n            referringItemFieldName: r.relationshipName,\n            referringItemId: itemId(r.left),\n            referencedItemId: itemId(r.right),\n          })),\n          ...toOptions(opts),\n        })\n      )\n    }\n  )\n\n  replaceReferences = withArgs(\n    async (\n      args,\n      collectionName: string,\n      relationshipAttribute: string,\n      left: WixDataItemOrId,\n      right: WixDataItemOrId | WixDataItemOrId[],\n      options?: WixDataOptions\n    ): Promise<void> => {\n      const rights = asArray(right)\n      await apiValidator()\n        .arity('replaceReferences', args, 4, 5)\n        .collectionName(collectionName)\n        .isNonEmptyString(relationshipAttribute, 'relationshipAttribute')\n        .referenceParameter(left)\n        .referenceParameters(rights)\n        .options(options)\n        .validateAndReject()\n\n      await this.trace('replaceReferences', {\n        collectionName,\n        relationshipAttribute,\n      })(async (env) =>\n        this.client.replaceDataItemReferences({\n          ...env,\n          dataCollectionId: collectionName,\n          referringItemFieldName: relationshipAttribute,\n          referringItemId: itemId(left),\n          newReferencedItemIds: rights.map(itemId),\n          ...toOptions(options),\n        })\n      )\n    }\n  )\n\n  removeReference = withArgs(\n    async (\n      args,\n      collectionName: string,\n      relationshipAttribute: string,\n      left: WixDataItemOrId,\n      right: WixDataItemOrId | WixDataItemOrId[],\n      options?: WixDataOptions\n    ) => {\n      const rights = asArray(right)\n      await apiValidator()\n        .arity('removeReference', args, 4, 5)\n        .collectionName(collectionName)\n        .referenceParameter(left)\n        .referenceRemoveParameters(rights)\n        .isNonEmptyString(relationshipAttribute, 'relationshipAttribute')\n        .options(options)\n        .validateAndReject()\n\n      await this.trace('removeReference', {\n        collectionName,\n        relationshipAttribute,\n      })(async (env) =>\n        this.client.bulkRemoveDataItemReferences({\n          ...env,\n          dataCollectionId: collectionName,\n          dataItemReferences: rights.map((r) => ({\n            referringItemFieldName: relationshipAttribute,\n            referringItemId: itemId(left),\n            referencedItemId: itemId(r),\n          })),\n          ...toOptions(options),\n        })\n      )\n    }\n  )\n\n  isReferenced = withArgs(\n    async (\n      args,\n      collectionName: string,\n      relationshipAttribute: string,\n      left: WixDataItemOrId,\n      right: WixDataItemOrId,\n      options?: WixDataReadOptions\n    ): Promise<boolean> => {\n      await apiValidator()\n        .arity('isReferenced', args, 4, 5)\n        .collectionName(collectionName)\n        .referenceParameter(left)\n        .referenceParameter(right)\n        .options(options)\n        .validateAndReject()\n\n      return this.trace('isReferenced', {\n        collectionName,\n        relationshipAttribute,\n      })(async (env) => {\n        const { isReferenced } = await this.client.isReferencedDataItem({\n          ...env,\n          dataCollectionId: collectionName,\n          referringItemFieldName: relationshipAttribute,\n          referringItemId: itemId(left),\n          referencedItemId: itemId(right),\n          ...toReadOptions(options),\n          consistentRead: options?.consistentRead,\n        })\n        return isReferenced!\n      })\n    }\n  )\n\n  private trace(\n    action: string,\n    opts: object\n  ): <R>(\n    fn: (env: {\n      environment?: apiTypes.Environment\n      appId?: string\n    }) => Promise<R>\n  ) => Promise<R> {\n    return async (fn) => {\n      const gridAppId = await get(this.gridAppId)\n      const env = { appId: gridAppId, environment: this.environment }\n      if (this.tracer) {\n        return this.tracer(`WixDataApi.${action}`, {\n          ...opts,\n          gridAppId,\n          environment: this.environment,\n        })(() => fn(env))\n      }\n      return fn(env)\n    }\n  }\n}\n\nfunction withArgs<Args extends any[], R>(\n  fn: (all: IArguments, ...args: Args) => R\n): (...args: Args) => R {\n  return function (...args) {\n    return fn(arguments, ...args)\n  }\n}\n\nfunction toPatchOptions(options?: WixDataPatchOptions) {\n  return {\n    suppressHooks: options?.suppressHooks,\n    ...draftsOptions(options?.showDrafts),\n  }\n}\n\nfunction toUpdateOptions(options?: WixDataUpdateOptions) {\n  return {\n    ...toOptions(options),\n    includeReferencedItems: options?.includeReferences,\n  }\n}\n\nfunction toOptions(opts?: WixDataOptions) {\n  if (!opts) {\n    return undefined\n  }\n  const res = {\n    suppressHooks: opts.suppressHooks,\n    appOptions: opts.appOptions,\n    ...draftsOptions(opts?.showDrafts),\n  }\n  if (Object.entries(res).every((kv) => kv[1] === undefined)) {\n    return undefined\n  }\n  return res\n}\n\nfunction toReadOptions(options?: WixDataReadOptions) {\n  return {\n    suppressHooks: options?.suppressHooks,\n    appOptions: options?.appOptions,\n    ...draftsOptions(options?.showDrafts),\n    consistentRead: options?.consistentRead,\n    language: options?.language,\n  }\n}\n\nfunction draftsOptions(showDrafts?: boolean) {\n  return showDrafts !== undefined\n    ? { publishPluginOptions: { includeDraftItems: showDrafts } }\n    : {}\n}\n\nfunction toDataItem(item: apiTypes.DataItem): WixDataItem {\n  return item.data as WixDataItem\n}\n\nfunction toPaging(limit: number | undefined, cursorOrOffset: string | number) {\n  return typeof cursorOrOffset === 'string'\n    ? {\n        cursorPaging: {\n          limit,\n          cursor: cursorOrOffset,\n        },\n      }\n    : limit !== undefined || cursorOrOffset > 0\n    ? {\n        paging: {\n          limit,\n          offset: cursorOrOffset,\n        },\n      }\n    : {}\n}\n\nfunction toSort(orderBy: QueryParams['orderBy']): apiTypes.Sorting[] {\n  return orderBy.map((fieldOrder) => {\n    const [[fieldName, sort]] = Object.entries(fieldOrder)\n    const order =\n      sort === 'asc'\n        ? apiTypes.SortOrder.ASC\n        : sort === 'desc'\n        ? apiTypes.SortOrder.DESC\n        : undefined\n    return { fieldName, order }\n  })\n}\n\nasync function get<T>(providerOrValue: T | Provider<T>): Promise<T> {\n  if (typeof (providerOrValue as any)?.get === 'function') {\n    return (providerOrValue as Provider<T>).get()\n  }\n  return providerOrValue as T\n}\n\nfunction recover<T>(code: string, value: T): (error: unknown) => Promise<T> {\n  return (error) => {\n    if (\n      error instanceof Error &&\n      (error as any)?.details?.applicationError?.code === code\n    ) {\n      return Promise.resolve(value)\n    }\n    return Promise.reject(error)\n  }\n}\n\nfunction warnAboutBrokenFields(item: Partial<WixDataItem>) {\n  const hasFieldWithDollar = hasField(item, (key) => key.startsWith('$'))\n  const hasFieldWithDot = hasField(item, (key) => key.includes('.'))\n  if (hasFieldWithDollar) {\n    console.error(\n      \"Data inserted contains field name prefixed with symbol '$'. It is not recommended to use such field names as it will not work with some data operations.\"\n    )\n  }\n  if (hasFieldWithDot) {\n    console.warn(\n      \"Data inserted contains field name containing symbol '.'. It is not recommended to use such field names as it will not work with some data operations.\"\n    )\n  }\n}\n\nfunction toBulkResult(\n  request: any[],\n  results: apiTypes.BulkDataItemResult[],\n  ignoreCodes: string[] = []\n): WixDataBulkResult {\n  const errors = results.flatMap((r) => {\n    if (r.itemMetadata?.success || !r.itemMetadata?.error) {\n      return []\n    }\n    if (ignoreCodes.includes(r.itemMetadata.error.code ?? '')) {\n      return []\n    }\n    return [\n      new BulkError(\n        r.itemMetadata.error.description!,\n        r.itemMetadata.error.code!,\n        request[r.itemMetadata.originalIndex!],\n        'BulkError',\n        r.itemMetadata.originalIndex!\n      ),\n    ]\n  })\n  const success = results.filter((r) => r.itemMetadata?.success)\n  const inserted = success.filter(\n    (r) => r.action === apiTypes.BulkActionType.INSERT\n  )\n  const updated = success.filter(\n    (r) =>\n      r.action === apiTypes.BulkActionType.UPDATE ||\n      r.action === apiTypes.BulkActionType.PATCH\n  )\n  const removed = success.filter(\n    (r) => r.action === apiTypes.BulkActionType.DELETE\n  )\n  return {\n    inserted: inserted.length,\n    updated: updated.length,\n    removed: removed.length,\n    skipped: request.length - errors.length - success.length,\n    errors,\n    insertedItemIds: inserted.map((r) => r.itemMetadata?.id!),\n    updatedItemIds: updated.map((r) => r.itemMetadata?.id!),\n    removedItemIds: removed.map((r) => r.itemMetadata?.id!),\n  }\n}\n\nfunction unwrapAggregationId(\n  items: Record<string, any>[]\n): Record<string, any>[] {\n  // When grouping by one field WixDataService returns value on _id field directly, DataItemService wraps it in an object, i.e.\n  // grouping by surname returns {_id: 'Simpson'} in WixDataService vs {_id: {surname: 'Simpson'}} in DataItemService\n  // When grouping by more fields, values are kept wrapped.\n  return items.map((item) => {\n    const id = item._id\n    if (isObject(id)) {\n      const [key, ...rest] = Object.keys(id)\n      if (rest.length === 0) {\n        item._id = id[key]\n        return item\n      }\n    }\n    return item\n  })\n}\n\nfunction onlyReferencedItems(\n  results: apiTypes.ReferencedResult[]\n): WixDataItem[] {\n  return results\n    .map((result) => result.dataItem)\n    .filter(notEmpty)\n    .map(toDataItem)\n}\n\nfunction notEmpty<T>(value: T | null | undefined): value is T {\n  return value != null\n}\n\nfunction itemId(item: WixDataItemOrId): string {\n  return typeof item === 'string' ? item : item._id\n}\n\nfunction asArray<T>(xOrXs: T | T[]): T[] {\n  return isArray(xOrXs) ? (xOrXs as T[]) : [xOrXs as T]\n}\n\nfunction isOffset(cursorOrOffset: string | number) {\n  return typeof cursorOrOffset === 'number'\n}\n\nconst ItemDoesNotExistCode = 'WDE0073'\n\nfunction apiValidator() {\n  return commonApiValidator(wdeValidationError)\n}\n"],"mappings":"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","ignoreList":[]}